<html><head><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-151329628-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-151329628-1');
</script>
<meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="styles/branding.css" /><link rel="stylesheet" type="text/css" href="styles/branding-en-US.css" /><script type="text/javascript" src="scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>SchemaManager.UpgradeDatabaseAsync Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="UpgradeDatabaseAsync method" /><meta name="System.Keywords" content="SchemaManager.UpgradeDatabaseAsync method" /><meta name="Microsoft.Help.F1" content="Neon.Postgres.SchemaManager.UpgradeDatabaseAsync" /><meta name="Microsoft.Help.Id" content="M:Neon.Postgres.SchemaManager.UpgradeDatabaseAsync(System.String,System.Int32,System.Boolean,System.Action{System.Boolean,System.Int32})" /><meta name="Description" content="Upgrades the database by applying any upgrade scripts from the current database version to the latest update script found in the script folder or optionally when the database version equals ." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Neon.Postgres" /><meta name="file" content="M_Neon_Postgres_SchemaManager_UpgradeDatabaseAsync" /><meta name="guid" content="M_Neon_Postgres_SchemaManager_UpgradeDatabaseAsync" /><link rel="stylesheet" type="text/css" href="styles/branding-Website.css" /><script type="text/javascript" src="scripts/jquery-3.3.1.min.js"></script><script type="text/javascript" src="scripts/branding-Website.js"></script><script type="text/javascript" src="scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Neon and neonKUBE class libraries and tools<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="index.html" title="Neon and neonKUBE class libraries and tools" tocid="roottoc">Neon and neonKUBE class libraries and tools</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="R_Project_neon.htm" title="Neon Namespaces" tocid="R_Project_neon">Neon Namespaces</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="N_Neon_Postgres.htm" title="Neon.Postgres" tocid="N_Neon_Postgres">Neon.Postgres</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="T_Neon_Postgres_SchemaManager.htm" title="SchemaManager Class" tocid="T_Neon_Postgres_SchemaManager">SchemaManager Class</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="Methods_T_Neon_Postgres_SchemaManager.htm" title="SchemaManager Methods" tocid="Methods_T_Neon_Postgres_SchemaManager">SchemaManager Methods</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_Neon_Postgres_SchemaManager_CreateDatabaseAsync.htm" title="CreateDatabaseAsync Method " tocid="M_Neon_Postgres_SchemaManager_CreateDatabaseAsync">CreateDatabaseAsync Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="Overload_Neon_Postgres_SchemaManager_Dispose.htm" title="Dispose Method " tocid="Overload_Neon_Postgres_SchemaManager_Dispose">Dispose Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_Neon_Postgres_SchemaManager_Finalize.htm" title="Finalize Method " tocid="M_Neon_Postgres_SchemaManager_Finalize">Finalize Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_Neon_Postgres_SchemaManager_GetStatusAsync.htm" title="GetStatusAsync Method " tocid="M_Neon_Postgres_SchemaManager_GetStatusAsync">GetStatusAsync Method </a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="M_Neon_Postgres_SchemaManager_UpgradeDatabaseAsync.htm" title="UpgradeDatabaseAsync Method " tocid="M_Neon_Postgres_SchemaManager_UpgradeDatabaseAsync">UpgradeDatabaseAsync Method </a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="icons/Help.png" /></td><td class="titleColumn"><h1>SchemaManager<span id="LST878A50F1_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST878A50F1_0?cpp=::|nu=.");</script>UpgradeDatabaseAsync Method </h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            Upgrades the database by applying any upgrade scripts from the current database
            version to the latest update script found in the script folder or optionally when
            the database version equals <span class="parameter">stopVersion</span>.
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="N_Neon_Postgres.htm">Neon.Postgres</a><br />
    <strong>Assembly:</strong>
   Neon.Postgres (in Neon.Postgres.dll) Version: 2.10.0<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EDCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EDCA','cs','1','4');return false;">C#</a></div><div id="ID0EDCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EDCA','vb','2','4');return false;">VB</a></div><div id="ID0EDCA_tab3" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EDCA','cpp','3','4');return false;">C++</a></div><div id="ID0EDCA_tab4" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EDCA','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EDCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EDCA');return false;" title="Copy">Copy</a></div></div><div id="ID0EDCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="identifier">Task</span>&lt;<span class="identifier">int</span>&gt; <span class="identifier">UpgradeDatabaseAsync</span>(
	<span class="identifier">string</span> <span class="parameter">updaterIdentity</span> = <span class="keyword">null</span>,
	<span class="identifier">int</span> <span class="parameter">stopVersion</span> = -1,
	<span class="identifier">bool</span> <span class="parameter">force</span> = <span class="keyword">false</span>,
	<span class="identifier">Action</span>&lt;<span class="identifier">bool</span>, <span class="identifier">int</span>&gt; <span class="parameter">updateAction</span> = <span class="keyword">null</span>
)</pre></div><div id="ID0EDCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Function</span> <span class="identifier">UpgradeDatabaseAsync</span> ( 
	Optional <span class="parameter">updaterIdentity</span> <span class="keyword">As</span> <span class="identifier">String</span> = <span class="keyword">Nothing</span>,
	Optional <span class="parameter">stopVersion</span> <span class="keyword">As</span> <span class="identifier">Integer</span> = -1,
	Optional <span class="parameter">force</span> <span class="keyword">As</span> <span class="identifier">Boolean</span> = <span class="keyword">false</span>,
	Optional <span class="parameter">updateAction</span> <span class="keyword">As</span> <span class="identifier">Action</span>(<span class="keyword">Of</span> <span class="identifier">Boolean</span>, <span class="identifier">Integer</span>) = <span class="keyword">Nothing</span>
) <span class="keyword">As</span> <span class="identifier">Task</span>(<span class="keyword">Of</span> <span class="identifier">Integer</span>)</pre></div><div id="ID0EDCA_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="identifier">Task</span>&lt;<span class="identifier">int</span>&gt;^ <span class="identifier">UpgradeDatabaseAsync</span>(
	<span class="identifier">String</span>^ <span class="parameter">updaterIdentity</span> = <span class="keyword">nullptr</span>, 
	<span class="identifier">int</span> <span class="parameter">stopVersion</span> = -1, 
	<span class="identifier">bool</span> <span class="parameter">force</span> = <span class="keyword">false</span>, 
	<span class="identifier">Action</span>&lt;<span class="identifier">bool</span>, <span class="identifier">int</span>&gt;^ <span class="parameter">updateAction</span> = <span class="keyword">nullptr</span>
)</pre></div><div id="ID0EDCA_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">member</span> <span class="identifier">UpgradeDatabaseAsync</span> : 
        ?<span class="parameter">updaterIdentity</span> : <span class="identifier">string</span> * 
        ?<span class="parameter">stopVersion</span> : <span class="identifier">int</span> * 
        ?<span class="parameter">force</span> : <span class="identifier">bool</span> * 
        ?<span class="parameter">updateAction</span> : <span class="identifier">Action</span>&lt;<span class="identifier">bool</span>, <span class="identifier">int</span>&gt; 
(* Defaults:
        <span class="keyword">let </span><span class="identifier">_</span><span class="identifier">updaterIdentity</span> = defaultArg <span class="identifier">updaterIdentity</span> <span class="keyword">null</span>
        <span class="keyword">let </span><span class="identifier">_</span><span class="identifier">stopVersion</span> = defaultArg <span class="identifier">stopVersion</span> -1
        <span class="keyword">let </span><span class="identifier">_</span><span class="identifier">force</span> = defaultArg <span class="identifier">force</span> <span class="keyword">false</span>
        <span class="keyword">let </span><span class="identifier">_</span><span class="identifier">updateAction</span> = defaultArg <span class="identifier">updateAction</span> <span class="keyword">null</span>
*)
<span class="keyword">-&gt;</span> <span class="identifier">Task</span>&lt;<span class="identifier">int</span>&gt; 
</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EDCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">updaterIdentity</span> (Optional)</dt><dd>Type: <a href="https://docs.microsoft.com/dotnet/api/system.string" target="_blank">System<span id="LST878A50F1_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST878A50F1_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br /><p>
            Optionally specifies the identity of the entity performing the update.  This may be the
            username of the person doing this or something identifying the service instance for
            more automated scenarios.  This service identity could be a hostname, container ID,
            or something else that makes sense.  This is used to ensure that only a single entity
            can update the database.
            </p><p>
            This defaults to a generated GUID.
            </p></dd><dt><span class="parameter">stopVersion</span> (Optional)</dt><dd>Type: <a href="https://docs.microsoft.com/dotnet/api/system.int32" target="_blank">System<span id="LST878A50F1_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST878A50F1_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><br />Optionally specifies the latest database update to apply.</dd><dt><span class="parameter">force</span> (Optional)</dt><dd>Type: <a href="https://docs.microsoft.com/dotnet/api/system.boolean" target="_blank">System<span id="LST878A50F1_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST878A50F1_3?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Boolean</a><br /><p>
            Optionally specifies that any indication that another updater is in the process of
            updating the database will be ignored and that any pewnding updates will proceed.
            This may be necessary after a previous update failed.
            </p><div class="alert"><table><tr><th><img src="icons/AlertNote.png" alt="Note" /> Note</th></tr><tr><td><b>WARNING:</b> You should take care to ensure that the other potential updater is
            not actually performing an update.  This may also means that the previous update
            was only partially completed which could require manual intervention.
            </td></tr></table></div></dd><dt><span class="parameter">updateAction</span> (Optional)</dt><dd>Type: <a href="https://docs.microsoft.com/dotnet/api/system.action-2" target="_blank">System<span id="LST878A50F1_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST878A50F1_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Action</a><span id="LST878A50F1_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST878A50F1_5?cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=(");</script><a href="https://docs.microsoft.com/dotnet/api/system.boolean" target="_blank">Boolean</a>, <a href="https://docs.microsoft.com/dotnet/api/system.int32" target="_blank">Int32</a><span id="LST878A50F1_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST878A50F1_6?cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)");</script><br />
            Optional action that will be called before each update is applied and then afterwards.
            The <span class="code">bool</span> argument will be <span class="code">false</span> before the update is applied and <span class="code">true</span>
            afterwards.  The <span class="code">int</span> argument is the schema version being applied.
            </dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="https://docs.microsoft.com/dotnet/api/system.threading.tasks.task-1" target="_blank">Task</a><span id="LST878A50F1_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST878A50F1_7?cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=(");</script><a href="https://docs.microsoft.com/dotnet/api/system.int32" target="_blank">Int32</a><span id="LST878A50F1_8"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST878A50F1_8?cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)");</script><br />The version of the database after the upgrade.</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="icons/SectionExpanded.png" />Exceptions</span></div><div id="ID2RBSection" class="collapsibleSection"><div class="tableSection"><table><tr><th>Exception</th><th>Condition</th></tr><tr><td><a href="T_Neon_Postgres_SchemaManagerException.htm">SchemaManagerException</a></td><td>
            Thrown if the database doesn't exist or does not include the
            <a href="F_Neon_Postgres_SchemaManager_DbInfoTableName.htm">DbInfoTableName</a> table or if it invalid.
            </td></tr><tr><td><a href="https://docs.microsoft.com/dotnet/api/system.io.filenotfoundexception" target="_blank">FileNotFoundException</a></td><td>
            Thrown if the <b>schema-0.script</b> file does not exist or when there are
            any missing script files (e.g. gaps in the sequence of files) or there
            are scripts with unexpected file names.
            </td></tr><tr><td><a href="T_Neon_Postgres_SchemaManagerException.htm">SchemaManagerException</a></td><td>
            Thrown when another entity currently is in the process of updating the
            database schema.
            </td></tr></table></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="icons/SectionExpanded.png" />Remarks</span></div><div id="ID3RBSection" class="collapsibleSection"><div class="alert"><table><tr><th><img src="icons/AlertNote.png" alt="Note" /> Note</th></tr><tr><td><b>IMPORTANT:</b> This method does not perform the schema updates within a transaction
            because that will be impractical for large databases and also due to limitations of
            YugaByte Postgres.  This means that you'll need to take care to ensure that your
            schema scripts are well tested and bulletproof and you should also consider backing
            up your database to be very safe.
            </td></tr></table></div></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="icons/SectionExpanded.png" />See Also</span></div><div id="ID4RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="T_Neon_Postgres_SchemaManager.htm">SchemaManager Class</a></div><div class="seeAlsoStyle"><a href="N_Neon_Postgres.htm">Neon.Postgres Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter">Offline help available for Windows: <a href="neon.chm">neon.chm</a><br />
Report any issues at: <a href="https://github.com/nforgeio/neonKUBE">https://github.com/nforgeio/neonKUBE</a><p>Copyright (c) 2005-2020 by neonFORGE LLC.  All rights reserved.</p> </div></body></html>